<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spark Docs — Document Converter</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
<style>
  :root {
    --navy:   #1E3A5F;
    --blue:   #2E6DA4;
    --sky:    #D6E8F7;
    --gold:   #C8960C;
    --gold-lt:#FEF3D0;
    --ink:    #1A1A2E;
    --mist:   #F5F7FA;
    --border: #DDE3EC;
    --mid:    #6B7A8D;
    --white:  #FFFFFF;
    --radius: 10px;
    --serif:  'DM Serif Display', Georgia, serif;
    --sans:   'DM Sans', system-ui, sans-serif;
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: var(--sans);
    background: var(--mist);
    color: var(--ink);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  /* ── Header ── */
  header {
    background: var(--navy);
    padding: 20px 24px;
    display: flex;
    align-items: center;
    gap: 14px;
    border-bottom: 3px solid var(--gold);
  }
  .logo-mark {
    width: 38px; height: 38px;
    background: var(--gold);
    border-radius: 8px;
    display: flex; align-items: center; justify-content: center;
    font-family: var(--serif);
    font-size: 20px;
    color: var(--navy);
    flex-shrink: 0;
    font-weight: 700;
  }
  .header-text h1 {
    font-family: var(--serif);
    font-size: 18px;
    color: var(--white);
    letter-spacing: 0.01em;
    line-height: 1.2;
  }
  .header-text p {
    font-size: 12px;
    color: rgba(255,255,255,0.55);
    font-weight: 300;
    margin-top: 1px;
  }

  /* ── Main ── */
  main {
    flex: 1;
    padding: 32px 20px 60px;
    max-width: 720px;
    margin: 0 auto;
    width: 100%;
  }

  /* ── Drop Zone ── */
  #converter-view { animation: fadeIn 0.4s ease; }

  .intro {
    text-align: center;
    margin-bottom: 32px;
  }
  .intro h2 {
    font-family: var(--serif);
    font-size: clamp(22px, 5vw, 30px);
    color: var(--navy);
    margin-bottom: 10px;
  }
  .intro p {
    font-size: 15px;
    color: var(--mid);
    line-height: 1.6;
    max-width: 480px;
    margin: 0 auto;
  }

  #drop-zone {
    border: 2px dashed var(--blue);
    border-radius: var(--radius);
    background: var(--white);
    padding: 48px 24px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
  }
  #drop-zone:hover, #drop-zone.dragover {
    border-color: var(--gold);
    background: var(--gold-lt);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(200,150,12,0.15);
  }
  #drop-zone input[type="file"] {
    position: absolute; inset: 0; opacity: 0; cursor: pointer; width: 100%; height: 100%;
  }
  .drop-icon {
    width: 56px; height: 56px;
    background: var(--sky);
    border-radius: 50%;
    margin: 0 auto 16px;
    display: flex; align-items: center; justify-content: center;
  }
  .drop-icon svg { width: 26px; height: 26px; stroke: var(--blue); }
  #drop-zone h3 { font-size: 17px; font-weight: 600; color: var(--navy); margin-bottom: 6px; }
  #drop-zone p  { font-size: 14px; color: var(--mid); }
  #drop-zone .file-type-badge {
    display: inline-block;
    margin-top: 16px;
    background: var(--sky);
    color: var(--blue);
    font-size: 12px;
    font-weight: 600;
    padding: 4px 12px;
    border-radius: 20px;
    letter-spacing: 0.05em;
  }

  /* ── Processing ── */
  #processing-view {
    display: none;
    text-align: center;
    padding: 80px 20px;
    animation: fadeIn 0.3s ease;
  }
  .spinner {
    width: 48px; height: 48px;
    border: 3px solid var(--border);
    border-top-color: var(--blue);
    border-radius: 50%;
    margin: 0 auto 20px;
    animation: spin 0.8s linear infinite;
  }
  #processing-view p { color: var(--mid); font-size: 15px; }

  /* ── Result ── */
  #result-view {
    display: none;
    animation: fadeIn 0.4s ease;
  }

  .result-bar {
    background: var(--navy);
    border-radius: var(--radius);
    padding: 16px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }
  .result-bar-left {
    display: flex; align-items: center; gap: 12px;
  }
  .result-icon {
    width: 36px; height: 36px;
    background: rgba(255,255,255,0.1);
    border-radius: 8px;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
  }
  .result-icon svg { width: 18px; height: 18px; stroke: var(--gold); }
  .result-filename { font-size: 14px; font-weight: 600; color: var(--white); }
  .result-meta { font-size: 12px; color: rgba(255,255,255,0.5); margin-top: 2px; }

  .btn-row { display: flex; gap: 10px; flex-wrap: wrap; }
  .btn {
    display: inline-flex; align-items: center; gap: 7px;
    padding: 9px 18px;
    border-radius: 7px;
    font-family: var(--sans);
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    border: none;
    text-decoration: none;
    transition: all 0.18s ease;
    white-space: nowrap;
  }
  .btn svg { width: 15px; height: 15px; flex-shrink: 0; }
  .btn-primary { background: var(--gold); color: var(--navy); }
  .btn-primary:hover { background: #b8860b; transform: translateY(-1px); }
  .btn-secondary { background: rgba(255,255,255,0.12); color: var(--white); }
  .btn-secondary:hover { background: rgba(255,255,255,0.2); }

  /* ── Document Preview ── */
  #doc-preview {
    background: var(--white);
    border-radius: var(--radius);
    border: 1px solid var(--border);
    overflow: hidden;
  }
  .preview-label {
    background: var(--mist);
    border-bottom: 1px solid var(--border);
    padding: 10px 20px;
    font-size: 12px;
    font-weight: 600;
    color: var(--mid);
    text-transform: uppercase;
    letter-spacing: 0.07em;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .preview-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--blue); }
  .doc-content {
    padding: 32px 28px 48px;
    font-family: var(--sans);
    font-size: 15px;
    line-height: 1.75;
    color: var(--ink);
  }

  /* ── Rendered doc typography ── */
  .doc-content h1 {
    font-family: var(--serif);
    font-size: clamp(22px, 4vw, 28px);
    color: var(--navy);
    margin: 36px 0 10px;
    line-height: 1.25;
    padding-bottom: 10px;
    border-bottom: 2px solid var(--sky);
  }
  .doc-content h1:first-child { margin-top: 0; }
  .doc-content h2 {
    font-family: var(--serif);
    font-size: clamp(17px, 3vw, 21px);
    color: var(--blue);
    margin: 28px 0 8px;
    line-height: 1.3;
  }
  .doc-content h3 {
    font-size: 15px;
    font-weight: 700;
    color: var(--navy);
    margin: 22px 0 6px;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    font-size: 12px;
  }
  .doc-content p { margin: 0 0 14px; }
  .doc-content p:last-child { margin-bottom: 0; }
  .doc-content strong { font-weight: 600; color: var(--navy); }
  .doc-content em { font-style: italic; color: var(--mid); }
  .doc-content ul, .doc-content ol {
    padding-left: 22px;
    margin: 0 0 16px;
  }
  .doc-content li { margin-bottom: 6px; }
  .doc-content table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    font-size: 14px;
  }
  .doc-content td, .doc-content th {
    border: 1px solid var(--border);
    padding: 10px 14px;
    vertical-align: top;
    line-height: 1.55;
  }
  .doc-content tr:nth-child(even) td { background: var(--mist); }
  .doc-content th {
    background: var(--navy);
    color: var(--white);
    font-weight: 600;
    font-size: 13px;
  }
  .doc-content blockquote {
    border-left: 3px solid var(--gold);
    background: var(--gold-lt);
    padding: 14px 18px;
    margin: 20px 0;
    border-radius: 0 6px 6px 0;
    font-style: italic;
  }
  .doc-content hr {
    border: none;
    border-top: 1px solid var(--border);
    margin: 28px 0;
  }

  /* ── Convert another ── */
  .convert-another {
    margin-top: 24px;
    text-align: center;
  }
  .convert-another button {
    background: none;
    border: none;
    color: var(--blue);
    font-family: var(--sans);
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    text-decoration: underline;
    text-underline-offset: 3px;
  }
  .convert-another button:hover { color: var(--navy); }

  /* ── How it works ── */
  .how-it-works {
    margin-top: 36px;
    border-top: 1px solid var(--border);
    padding-top: 28px;
  }
  .how-it-works h4 {
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--mid);
    margin-bottom: 16px;
  }
  .steps { display: flex; flex-direction: column; gap: 12px; }
  .step {
    display: flex;
    gap: 14px;
    align-items: flex-start;
    background: var(--white);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 14px 16px;
  }
  .step-num {
    width: 26px; height: 26px;
    background: var(--navy);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 12px;
    font-weight: 700;
    color: var(--white);
    flex-shrink: 0;
    margin-top: 1px;
  }
  .step-body h5 { font-size: 14px; font-weight: 600; color: var(--navy); margin-bottom: 3px; }
  .step-body p  { font-size: 13px; color: var(--mid); line-height: 1.5; }
  .step-body code {
    background: var(--sky);
    color: var(--blue);
    font-size: 12px;
    padding: 1px 6px;
    border-radius: 4px;
    font-family: 'Courier New', monospace;
  }

  /* ── Footer ── */
  footer {
    text-align: center;
    padding: 16px;
    font-size: 12px;
    color: var(--mid);
    border-top: 1px solid var(--border);
    background: var(--white);
  }

  /* ── Animations ── */
  @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* ── Mobile tweaks ── */
  @media (max-width: 480px) {
    main { padding: 20px 14px 48px; }
    .doc-content { padding: 22px 18px 36px; }
    .result-bar { flex-direction: column; align-items: flex-start; }
    .doc-content table { font-size: 13px; }
    .doc-content td, .doc-content th { padding: 8px 10px; }
  }
</style>
</head>
<body>

<header>
  <div class="logo-mark">S</div>
  <div class="header-text">
    <h1>Spark Docs</h1>
    <p>Document Converter · Spark Academy Website Project</p>
  </div>
</header>

<main>

  <!-- CONVERTER VIEW -->
  <div id="converter-view">
    <div class="intro">
      <h2>Convert a document for easy reading</h2>
      <p>Drop any Word document from the Spark project and get a clean, mobile-friendly version instantly.</p>
    </div>

    <div id="drop-zone">
      <input type="file" id="file-input" accept=".docx">
      <div class="drop-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="17 8 12 3 7 8"/>
          <line x1="12" y1="3" x2="12" y2="15"/>
        </svg>
      </div>
      <h3>Drop your .docx file here</h3>
      <p>or tap to choose a file from your device</p>
      <span class="file-type-badge">.DOCX FILES ONLY</span>
    </div>

    <div class="how-it-works">
      <h4>How it works</h4>
      <div class="steps">
        <div class="step">
          <div class="step-num">1</div>
          <div class="step-body">
            <h5>Drop or select your .docx file</h5>
            <p>Works with any Word document from the Spark project — briefs, reports, strategy docs, anything.</p>
          </div>
        </div>
        <div class="step">
          <div class="step-num">2</div>
          <div class="step-body">
            <h5>Read it right here — or download the HTML</h5>
            <p>The document opens instantly in a clean, mobile-friendly format. Hit "Download HTML" to save a file you can share or host.</p>
          </div>
        </div>
        <div class="step">
          <div class="step-num">3</div>
          <div class="step-body">
            <h5>To publish it, drop the HTML file into the repo</h5>
            <p>Place the downloaded file in the <code>docs/</code> folder on GitHub. It becomes live at <code>your-site/docs/filename</code> automatically.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- PROCESSING VIEW -->
  <div id="processing-view">
    <div class="spinner"></div>
    <p>Converting your document&hellip;</p>
  </div>

  <!-- RESULT VIEW -->
  <div id="result-view">
    <div class="result-bar">
      <div class="result-bar-left">
        <div class="result-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
          </svg>
        </div>
        <div>
          <div class="result-filename" id="result-filename">document.docx</div>
          <div class="result-meta" id="result-meta">Ready to read</div>
        </div>
      </div>
      <div class="btn-row">
        <a id="download-btn" class="btn btn-primary" download>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          Download HTML
        </a>
        <button class="btn btn-secondary" onclick="resetConverter()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="1 4 1 10 7 10"/>
            <path d="M3.51 15a9 9 0 1 0 .49-3.89"/>
          </svg>
          New doc
        </button>
      </div>
    </div>

    <div id="doc-preview">
      <div class="preview-label">
        <div class="preview-dot"></div>
        Document Preview
      </div>
      <div class="doc-content" id="doc-content"></div>
    </div>

    <div class="convert-another">
      <button onclick="resetConverter()">Convert another document</button>
    </div>
  </div>

</main>

<footer>
  Spark Academy Website Project &nbsp;·&nbsp; For internal use only
</footer>

<script>
  const dropZone    = document.getElementById('drop-zone');
  const fileInput   = document.getElementById('file-input');
  const convView    = document.getElementById('converter-view');
  const procView    = document.getElementById('processing-view');
  const resultView  = document.getElementById('result-view');
  const docContent  = document.getElementById('doc-content');
  const dlBtn       = document.getElementById('download-btn');
  const resultName  = document.getElementById('result-filename');
  const resultMeta  = document.getElementById('result-meta');

  // Drag events
  dropZone.addEventListener('dragover', e => { e.preventDefault(); dropZone.classList.add('dragover'); });
  dropZone.addEventListener('dragleave', () => dropZone.classList.remove('dragover'));
  dropZone.addEventListener('drop', e => {
    e.preventDefault();
    dropZone.classList.remove('dragover');
    const file = e.dataTransfer.files[0];
    if (file) processFile(file);
  });
  fileInput.addEventListener('change', e => {
    if (e.target.files[0]) processFile(e.target.files[0]);
  });

  function processFile(file) {
    if (!file.name.endsWith('.docx')) {
      alert('Please upload a .docx file.');
      return;
    }

    // Show processing
    convView.style.display  = 'none';
    procView.style.display  = 'block';
    resultView.style.display = 'none';

    const reader = new FileReader();
    reader.onload = function(e) {
      mammoth.convertToHtml({ arrayBuffer: e.target.result })
        .then(result => {
          const html = result.value;
          const wordCount = html.replace(/<[^>]+>/g, ' ').split(/\s+/).filter(Boolean).length;
          const readTime = Math.max(1, Math.round(wordCount / 220));

          // Populate preview
          docContent.innerHTML = html;
          resultName.textContent = file.name;
          resultMeta.textContent = `~${wordCount.toLocaleString()} words · ${readTime} min read`;

          // Build downloadable HTML file
          const fullHtml = buildStandaloneHtml(file.name, html);
          const blob = new Blob([fullHtml], { type: 'text/html' });
          const url  = URL.createObjectURL(blob);
          const slug = file.name.replace(/\.docx$/i, '').replace(/\s+/g, '-').toLowerCase();
          dlBtn.href     = url;
          dlBtn.download = slug + '.html';

          procView.style.display   = 'none';
          resultView.style.display = 'block';
        })
        .catch(err => {
          procView.style.display = 'none';
          convView.style.display = 'block';
          alert('Could not convert this file. Make sure it is a valid .docx document.\n\n' + err.message);
        });
    };
    reader.readAsArrayBuffer(file);
  }

  function resetConverter() {
    resultView.style.display  = 'none';
    procView.style.display    = 'none';
    convView.style.display    = 'block';
    fileInput.value = '';
    docContent.innerHTML = '';
  }

  function buildStandaloneHtml(filename, bodyHtml) {
    const title = filename.replace(/\.docx$/i, '').replace(/[-_]/g, ' ');
    return `<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>${escHtml(title)} — Spark Academy</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&display=swap" rel="stylesheet">
<style>
:root{--navy:#1E3A5F;--blue:#2E6DA4;--sky:#D6E8F7;--gold:#C8960C;--gold-lt:#FEF3D0;--ink:#1A1A2E;--mist:#F5F7FA;--border:#DDE3EC;--mid:#6B7A8D;--white:#FFFFFF;}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'DM Sans',system-ui,sans-serif;background:var(--mist);color:var(--ink);min-height:100vh;}
.site-header{background:var(--navy);padding:16px 24px;border-bottom:3px solid var(--gold);display:flex;align-items:center;gap:12px;}
.logo-mark{width:34px;height:34px;background:var(--gold);border-radius:7px;display:flex;align-items:center;justify-content:center;font-family:'DM Serif Display',Georgia,serif;font-size:18px;color:var(--navy);font-weight:700;flex-shrink:0;}
.header-text h1{font-family:'DM Serif Display',Georgia,serif;font-size:16px;color:#fff;line-height:1.2;}
.header-text p{font-size:11px;color:rgba(255,255,255,0.5);margin-top:1px;}
.back-link{margin-left:auto;font-size:12px;color:rgba(255,255,255,0.6);text-decoration:none;font-weight:500;white-space:nowrap;}
.back-link:hover{color:#fff;}
.doc-wrapper{max-width:720px;margin:0 auto;padding:28px 20px 80px;}
.doc-card{background:var(--white);border-radius:10px;border:1px solid var(--border);overflow:hidden;}
.doc-title-bar{background:var(--navy);padding:22px 28px;border-bottom:3px solid var(--gold);}
.doc-title-bar h2{font-family:'DM Serif Display',Georgia,serif;font-size:clamp(18px,4vw,24px);color:#fff;line-height:1.25;}
.doc-title-bar p{font-size:12px;color:rgba(255,255,255,0.5);margin-top:5px;}
.doc-content{padding:32px 28px 48px;font-size:15px;line-height:1.75;color:var(--ink);}
.doc-content h1{font-family:'DM Serif Display',Georgia,serif;font-size:clamp(20px,4vw,26px);color:var(--navy);margin:36px 0 10px;padding-bottom:10px;border-bottom:2px solid var(--sky);line-height:1.25;}
.doc-content h1:first-child{margin-top:0;}
.doc-content h2{font-family:'DM Serif Display',Georgia,serif;font-size:clamp(16px,3vw,20px);color:var(--blue);margin:28px 0 8px;line-height:1.3;}
.doc-content h3{font-size:12px;font-weight:700;color:var(--navy);margin:22px 0 6px;text-transform:uppercase;letter-spacing:.06em;}
.doc-content p{margin:0 0 14px;}
.doc-content p:last-child{margin-bottom:0;}
.doc-content strong{font-weight:600;color:var(--navy);}
.doc-content em{font-style:italic;color:var(--mid);}
.doc-content ul,.doc-content ol{padding-left:22px;margin:0 0 16px;}
.doc-content li{margin-bottom:6px;}
.doc-content table{width:100%;border-collapse:collapse;margin:20px 0;font-size:14px;}
.doc-content td,.doc-content th{border:1px solid var(--border);padding:10px 14px;vertical-align:top;line-height:1.55;}
.doc-content tr:nth-child(even) td{background:var(--mist);}
.doc-content th{background:var(--navy);color:#fff;font-weight:600;font-size:13px;}
.doc-content blockquote{border-left:3px solid var(--gold);background:var(--gold-lt);padding:14px 18px;margin:20px 0;border-radius:0 6px 6px 0;font-style:italic;}
.doc-content hr{border:none;border-top:1px solid var(--border);margin:28px 0;}
@media(max-width:480px){.doc-content{padding:20px 16px 36px;}.doc-title-bar{padding:18px 18px;}.doc-content table{font-size:13px;}.doc-content td,.doc-content th{padding:8px 9px;}}
</style>
</head>
<body>
<header class="site-header">
  <div class="logo-mark">S</div>
  <div class="header-text">
    <h1>Spark Docs</h1>
    <p>Spark Academy Website Project</p>
  </div>
  <a href="../index.html" class="back-link">← All Documents</a>
</header>
<div class="doc-wrapper">
  <div class="doc-card">
    <div class="doc-title-bar">
      <h2>${escHtml(title)}</h2>
      <p>Spark Academy · Internal Document</p>
    </div>
    <div class="doc-content">
      ${bodyHtml}
    </div>
  </div>
</div>
</body>
</html>`;
  }

  function escHtml(str) {
    return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
  }
</script>
</body>
</html>
